---
import Nav from "../../components/cabinDetail/Nav.astro";
import BaseLayout from "../../layouts/BaseLayout.astro";
import Cabins from "../../components/cabinDetail/Cabins.astro";
import HeaderSvelte from "../../components/cabinDetail/Header.svelte";

import cabins from "../../data/cabins.json";
import BasicInfo from "../../components/cabinDetail/BasicInfo.astro";
import Description from "../../components/cabinDetail/Description.astro";
import Amenities from "../../components/cabinDetail/Amenities.astro";

import OtherInfo from "../../components/cabinDetail/OtherInfo.astro";
import Map from "../../components/Map.astro";
import Footer from "../../components/Footer.astro";
import HostfullyWidget from "../../components/HostfullyWidget.astro";
import type { Cabin } from "../../types/cabin";

export async function getStaticPaths() {
  return cabins.map((cabin) => ({
    params: {
      name: cabin.name,
    },
    props: {
      cabin,
    },
  }));
}

const { name } = Astro.params;
const cabin = Astro.props.cabin as Cabin;
---

<BaseLayout title={name}>
  <Nav />
  <HeaderSvelte
    name={cabin.name}
    state={cabin.state}
    city={cabin.city}
    fullGallery={cabin.gallery}
    client:load
  />
  <div class="wrapper">
    <div class="info">
      <BasicInfo cabin={cabin} />
      <svg
        width="100%"
        height="2"
        viewBox="0 0 716 2"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <line
          y1="1.0167"
          x2="716"
          y2="1.0167"
          stroke="#2F2D27"
          stroke-width="0.2"></line>
      </svg>
      <Description cabin={cabin} />
      <svg
        width="100%"
        height="2"
        viewBox="0 0 716 2"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <line
          y1="1.0167"
          x2="716"
          y2="1.0167"
          stroke="#2F2D27"
          stroke-width="0.2"></line>
      </svg>
      <Amenities cabin={cabin} />
    </div>
    <HostfullyWidget propertyId={cabin.uid} />
  </div>
  <OtherInfo cabin={cabin} />
  <!-- TODO: HANDLE UNDEFINED -->
  <Map label={cabin.map?.label} url={cabin.map?.url} />
  <Cabins />
  <Footer />
</BaseLayout>

<style>
  .wrapper {
    display: flex;
    gap: 32px;
  }

  .info {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 3em;
    margin-bottom: 3em;
  }

  /* RESPONSIVE */
  @media only screen and (max-width: 768px) {
    .wrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 32px;
    }
  }
</style>
